# 打包（归档）和压缩

## 概念和区别

**归档，也称之为打包，指的是一个文件或目录的集合，而这个集合被存储在一个文件中。**归档文件没有经过压缩，因此，它占用的空间是其中所有文件和目录的总和。

**压缩是指利用算法将文件进行处理，已达到保留最大文件信息，而让大文件体积变小的目的。其基本原理为，通过查找文件内的重复字节，建立一个相同字节的词典文件，并用一个代码表示。**

> 压缩又可以分为**有损压缩**和**无损压缩**。无损压缩很好理解，指的是压缩数据必须准确无误；有损压缩指的是即便丢失个别的数据，对文件也不会造成太大的影响。有损压缩广泛应用于动画、声音和图像文件中，典型代表就是影碟文件格式 mpeg、音乐文件格式 mp3 以及图像文件格式 jpg。

## tar打包命令

#### tar作为打包命令使用

```
[root@localhost ~]#tar [选项] 源文件或目录
```

常用的选项及各自的含义如表

|  选项   |                             含义                             |
| :-----: | :----------------------------------------------------------: |
|   -c    |                  将多个文件或目录进行打包。                  |
|   -A    |                  追加 tar 文件到归档文件。                   |
| -f 包名 | 指定包的文件名。包的扩展名是用来给管理员识别格式的，所以一定要正确指定扩展名； |
|   -v    |                      显示打包文件过程；                      |

> 需要注意的是，在使用 tar 命令指定选项时可以不在选项前面输入“-”。例如，使用“cvf”选项和 “-cvf”起到的作用一样。

#### tar作为解打包命令使用

```
[root@localhost ~]#tar [选项] 压缩包
```

常用的选项及各自的含义如表

|  选项   |                            含义                            |
| :-----: | :--------------------------------------------------------: |
|   -x    |                  对 tar 包做解打包操作。                   |
|   -f    |                指定要解压的 tar 包的包名。                 |
|   -t    | 只查看 tar 包中有哪些文件或目录，不对 tar 包做解打包操作。 |
| -C 目录 |                      指定解打包位置。                      |
|   -v    |                   显示解打包的具体过程。                   |

## tar命令做打包压缩（解压缩解打包）操作

```
[root@localhost ~]#tar [选项] 压缩包 源文件或目录
```

此处常用的选项有以下 2 个，分别是：

- ==-z：压缩和解压缩 ".tar.gz" 格式；==
- ==-j：压缩和解压缩 ".tar.bz2"格式。==

## zip命令

```
[root@localhost ~]#zip [选项] 压缩包名 源文件或源目录列表
注意，zip 压缩命令需要手工指定压缩之后的压缩包名，注意写清楚扩展名，以便解压缩时使用。
```

常用的选项及各自的含义如表

|   选项    |                             含义                             |
| :-------: | :----------------------------------------------------------: |
|    -r     |  递归压缩目录，及将制定目录下的所有文件以及子目录全部压缩。  |
|    -m     |  将文件压缩之后，删除原始文件，相当于把文件移到压缩文件中。  |
|    -v     |                   显示详细的压缩过程信息。                   |
|    -q     |              在压缩的时候不显示命令的执行过程。              |
| -压缩级别 | 压缩级别是从 1~9 的数字，-1 代表压缩速度更快，-9 代表压缩效果更好。 |
|    -u     |           更新压缩文件，即往压缩文件中添加新文件。           |

【1】zip命令的基本使用

```
[root@localhost ~]# zip ana.zip anaconda-ks.cfg
adding: anaconda-ks.cfg (deflated 37%)
#压缩
[root@localhost ~]# ll ana.zip
-rw-r--r-- 1 root root 935 6月 1716:00 ana.zip
#压缩文件生成
```

**所有的压缩命令都可以同时压缩多个文件**，例如：

```
[root@localhost ~]# zip test.zip install.log install.log.syslog
adding: install.log (deflated 72%)
adding: install.log.syslog (deflated 85%)
#同时压缩多个文件到test.zip压缩包中
[root@localhost ~]#ll test.zip
-rw-r--r-- 1 root root 8368 6月 1716:03 test.zip
#压缩文件生成
```

【2】使用 zip 命令压缩目录，需要使用“-r”选项，例如：

```
[root@localhost ~]# mkdir dir1
#建立测试目录
[root@localhost ~]# zip -r dir1.zip dir1
adding: dir1/(stored 0%)
#压缩目录
[root@localhost ~]# ls -dl dir1.zip
-rw-r--r-- 1 root root 160 6月 1716:22 dir1.zip
#压缩文件生成
```

## unzip命令

**unzip 命令可以查看和解压缩 zip 文件。**

```
[root@localhost ~]# unzip [选项] 压缩包名
```

常用的选项及各自的含义如表

|    选项     |                             含义                             |
| :---------: | :----------------------------------------------------------: |
|  -d 目录名  |                 将压缩文件解压到指定目录下。                 |
|     -n      |                解压时并不覆盖已经存在的文件。                |
|     -o      |         解压时覆盖已经存在的文件，并且无需用户确认。         |
|     -v      | 查看压缩文件的详细信息，包括压缩文件中包含的文件大小、文件名以及压缩比等，但并不做解压操作。 |
|     -t      |              测试压缩文件有无损坏，但并不解压。              |
| -x 文件列表 |           解压文件，但不包含文件列表中指定的文件。           |

例子:
<img src="https://raw.githubusercontent.com/Lii-ya/PicGO1/main/202303011621231.png" alt="img" style="zoom:67%;" />

## gzip命令

**gzip是Linux系统中经常用来对文件进行压缩和解压缩的命令，通过此命令压缩得到的新文件，其扩展名通常标记为“.gz”。**

> 再强调一下，gzip 命令只能用来压缩文件，不能压缩目录，即便指定了目录，也只能压缩目录内的所有文件。

```
[root@localhost ~]# gzip [选项] 源文件
```

**命令中的源文件，当进行压缩操作时，指的是普通文件；当进行解压缩操作时，指的是压缩文件。**

| 选项  |                             含义                             |
| :---: | :----------------------------------------------------------: |
|  -c   |          将压缩数据输出到标准输出中，并保留源文件。          |
|  -d   |                    对压缩文件进行解压缩。                    |
|  -r   |          递归压缩指定目录下以及子目录下的所有文件。          |
|  -v   |    对于每个压缩和解压缩的文件，显示相应的文件名和压缩比。    |
|  -l   | 对每一个压缩文件，显示以下字段：压缩文件的大小；未压缩文件的大小；压缩比；未压缩文件的名称。 |
| -数字 | 用于指定压缩等级，-1 压缩等级最低，压缩比最差；-9 压缩比最高。默认压缩比是 -6。 |

【1】如果压缩目录会出现什么情况？

![img](https://raw.githubusercontent.com/Lii-ya/PicGO1/main/202303011628341.png)

==在 Linux 中，打包和压缩是分开处理的。而 gzip 命令只会压缩，不能打包，所以才会出现没有打包目录，而只把目录下的文件进行压缩的情况。==

## gunzip命令

**gunzip是一个使用广泛的解压缩命令，它用于解压被gzip压缩过的文件（扩展名为.gz）**

```
[root@localhost ~]# gunzip [选项] 文件
```

| 选项 |                        含义                        |
| :--: | :------------------------------------------------: |
|  -r  | 递归处理，解压缩指定目录下以及子目录下的所有文件。 |
|  -c  |        把解压缩后的文件输出到标准输出设备。        |
|  -f  |    强制解压缩文件，不理会文件是否已存在等情况。    |
|  -l  |                 列出压缩文件内容。                 |
|  -v  |                 显示命令执行过程。                 |
|  -t  |    测试压缩文件是否正常，但不对其做解压缩操作。    |

## bzip2命令

bzip2 命令同 gzip 命令类似，只能对文件进行压缩（或解压缩），对于目录只能压缩（或解压缩）该目录及子目录下的所有文件。当执行压缩任务完成后，会生成一个以“.bz2”为后缀的压缩包。

".bz2"格式是 Linux 的另一种压缩格式，从理论上来讲，".bz2"格式的算法更先进、压缩比更好；而 ".gz"格式相对来讲的时间更快。

```
[root@localhost ~]# bzip2 [选项] 源文件
```

源文件指的要压缩或解压缩的文件，该命令常用的选项及各自的含义如表

| 选项  |                             含义                             |
| :---: | :----------------------------------------------------------: |
|  -d   | 执行解压缩，此时该选项后的源文件应为标记有 .bz2 后缀的压缩包文件。 |
|  -k   | bzip2 在压缩或解压缩任务完成后，会删除原始文件，若要保留原始文件，可使用此选项。 |
|  -f   | bzip2 在压缩或解压缩时，若输出文件与现有文件同名，默认不会覆盖现有文件，若使用此选项，则会强制覆盖现有文件。 |
|  -t   |                   测试压缩包文件的完整性。                   |
|  -v   |              压缩或解压缩文件时，显示详细信息。              |
| -数字 | 这个参数和 gzip 命令的作用一样，用于指定压缩等级，-1 压缩等级最低，压缩比最差；-9 压缩比最高 |

> 注意，gzip 只是不会打包目录，但是如果使用“-r”选项，则可以分别压缩目录下的每个文件；而 bzip2 命令则根本不支持压缩目录，也没有“-r”选项。

## bunzip2命令：bz2格式的解压缩命令

bunzip2 命令的使用和 gunzip 命令大致相同，bunzip2 命令只能用于解压文件，即便解压目录，也是解压该目录以及所含子目录下的所有文件。

```
[root@localhost ~]# bunzip2 [选项] 源文件
```

| 选项 |                             含义                             |
| :--: | :----------------------------------------------------------: |
|  -k  | 解压缩后，默认会删除原来的压缩文件。若要保留压缩文件，需使用此参数。 |
|  -f  | 解压缩时，若输出的文件与现有文件同名时，默认不会覆盖现有的文件。若要覆盖，可使用此选项。 |
|  -v  |                      显示命令执行过程。                      |
|  -L  |                      列出压缩文件内容。                      |

